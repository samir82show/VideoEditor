<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h2>#{videoController.video.concatPathName}</h2>
    <br /><br />
    <h:body>
        <video id="myVideo" controls="controls">
            <source src="#{videoController.video.concatPathName}" type="video/mp4"/>
        </video>
        <h:form id="timeForm" prependId="false">
            <h:inputHidden id="hiddenstartTtime"/>
            <h:inputHidden id="hiddenendTime"/>
            <h:commandButton value="Cut" action="#{videoController.runCommand()}" onclick="">
                <f:ajax onevent="monitor"/>
            </h:commandButton>
        </h:form>
        <br /><br />
        <h:graphicImage id="image" value="#{resource['image/source.gif']}" style="display:none; height: 10; width: 10"></h:graphicImage>
        <br /><br />
        <table border="2">
            <tr>
                <th>
                    <button id="start" name="assign video time" onclick="setStartTime()" >start time</button> 
                </th>
                <td>
                    <h:outputLabel id="starttimeLabel"/>
                </td>
            </tr>
            <tr>
                <th>
                    <button id="end" name="assign video time" onclick="setEndTime()" >end time</button>
                </th>
                <td>
                    <h:outputLabel id="endtimeLabel"/>
                </td>
            </tr>
        </table>
        <script>
            var video = document.getElementById("myVideo");

            document.getElementById("starttimeLabel").innerHTML = 0;
            document.getElementById("endtimeLabel").innerHTML = 0;

            function monitor(data) {
                var loading = document.getElementById("image");
                if (data.status == "begin") {
                    loading.style.display = "block";
                } else if (data.status == "success") {
                    loading.style.display = "none";
                }
            }

            function setStartTime() {
                document.getElementById("hiddenstartTtime").value = Math.round(video.currentTime);
                document.getElementById("starttimeLabel").innerHTML = Math.round(video.currentTime);
            }

            function setEndTime() {

                document.getElementById("hiddenendTime").value = Math.round(video.currentTime);
                document.getElementById("endtimeLabel").innerHTML = Math.round(video.currentTime);
            }
            document.addEventListener('contextmenu', function (e) {
                e.preventDefault();
            });

        </script> 

    </h:body>
</html>

